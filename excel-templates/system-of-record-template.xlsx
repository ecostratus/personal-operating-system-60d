# System of Record Template

This file would contain the actual Excel workbook implementing the **Canonical 10-Sheet SoR Schema** defined in `system-of-record-schema.md`.

## File: system-of-record-template.xlsx

**Note**: This is a placeholder file reference. The actual Excel file should be created with the following **10 canonical sheets** and structure:

---

## Canonical 10-Sheet Structure

### Sheet 1: **Roles**
Tracks all target roles under consideration.

**Excel Table Name**: `Roles`

**Columns**:
- `RoleID` — Text, Required, Unique
- `Title` — Text, Required
- `Seniority` — Text, Dropdown (e.g., Entry, Mid, Senior, Principal, Executive)
- `Function` — Text
- `Source` — Text
- `FitScore` — Number (0-100)
- `Status` — Dropdown: *Identified, Applied, Interviewing, Closed*
- `CompanyID` — Text, FK → Companies.CompanyID
- `LastUpdated` — Date, Required

**Data Validation**: Status dropdown with controlled list

---

### Sheet 2: **Companies**
Tracks companies associated with roles, outreach, or consulting.

**Excel Table Name**: `Companies`

**Columns**:
- `CompanyID` — Text, Required, Unique
- `Name` — Text, Required
- `Industry` — Text
- `Location` — Text
- `Size` — Text (e.g., Startup, Small, Medium, Large, Enterprise)
- `Website` — Text
- `Notes` — Text

---

### Sheet 3: **Contacts**
Tracks people associated with companies, outreach, or referrals.

**Excel Table Name**: `Contacts`

**Columns**:
- `ContactID` — Text, Required, Unique
- `Name` — Text, Required
- `Role` — Text
- `CompanyID` — Text, FK → Companies.CompanyID
- `Email` — Text
- `LinkedIn` — Text
- `RelationshipStrength` — Dropdown: *Weak, Warm, Strong*
- `Notes` — Text

**Data Validation**: RelationshipStrength dropdown with controlled list

---

### Sheet 4: **Outreach**
Tracks all outbound messages and follow-ups.

**Excel Table Name**: `Outreach`

**Columns**:
- `OutreachID` — Text, Required, Unique
- `ContactID` — Text, FK → Contacts.ContactID
- `CompanyID` — Text, FK → Companies.CompanyID
- `RoleID` — Text, FK → Roles.RoleID
- `Channel` — Dropdown: *Email, LinkedIn, Referral, Other*
- `MessageType` — Dropdown: *Intro, Follow-Up, Thank-You, Referral Ask*
- `SentDate` — Date
- `ResponseDate` — Date
- `ResponseType` — Dropdown: *Positive, Neutral, Negative, None*
- `NextActionDate` — Date
- `Notes` — Text

**Data Validation**: Channel, MessageType, ResponseType dropdowns with controlled lists

---

### Sheet 5: **Interviews**
Tracks interview stages and preparation.

**Excel Table Name**: `Interviews`

**Columns**:
- `InterviewID` — Text, Required, Unique
- `RoleID` — Text, FK → Roles.RoleID
- `CompanyID` — Text, FK → Companies.CompanyID
- `Stage` — Dropdown: *Screen, Hiring Manager, Panel, Final, Offer*
- `ScheduledDate` — Date
- `CompletedDate` — Date
- `Outcome` — Dropdown: *Pass, Fail, Pending*
- `Notes` — Text

**Data Validation**: Stage and Outcome dropdowns with controlled lists

---

### Sheet 6: **Consulting**
Tracks consulting opportunities and engagements.

**Excel Table Name**: `Consulting`

**Columns**:
- `ConsultingID` — Text, Required, Unique
- `CompanyID` — Text, FK → Companies.CompanyID
- `Type` — Dropdown: *Discovery, Proposal, Implementation, Retainer, Training*
- `Status` — Dropdown: *Open, In Progress, Closed Won, Closed Lost*
- `ValueEstimate` — Number (Currency format)
- `NextActionDate` — Date
- `Notes` — Text

**Data Validation**: Type and Status dropdowns with controlled lists

---

### Sheet 7: **Metrics**
Stores computed KPIs and summary metrics.

**Excel Table Name**: `Metrics`

**Columns**:
- `MetricName` — Text, Required
- `MetricValue` — Number or Text
- `LastUpdated` — Date

**Note**: This sheet is **populated by automation and dashboards**, not manually edited.

**Example Metrics**:
- `WeeklyApplications`
- `WeeklyOutreach`
- `TotalRolesIdentified`
- `ApplicationResponseRate`
- `InterviewConversionRate`

---

### Sheet 8: **StatusHistory**
Tracks every status change across Roles, Outreach, Interviews, and Consulting.

**Excel Table Name**: `StatusHistory`

**Columns**:
- `HistoryID` — Text, Required, Unique
- `EntityType` — Dropdown: *Role, Outreach, Interview, Consulting*
- `EntityID` — Text, Required
- `OldStatus` — Text
- `NewStatus` — Text
- `ChangedBy` — Text (e.g., "Automation", "Manual", "User")
- `ChangedAt` — DateTime, Required

**Data Validation**: EntityType dropdown with controlled list

**Note**: This is an **audit sheet** populated automatically when statuses change.

---

### Sheet 9: **FlowErrors**
Captures automation and Copilot Studio flow errors.

**Excel Table Name**: `FlowErrors`

**Columns**:
- `ErrorID` — Text, Required, Unique
- `FlowName` — Text, Required
- `Timestamp` — DateTime, Required
- `ErrorMessage` — Text, Required
- `Payload` — Text (JSON or error details)
- `Resolved` — Dropdown: *Yes, No*

**Data Validation**: Resolved dropdown with controlled list

**Note**: This sheet logs **flow and automation errors** for troubleshooting.

---

### Sheet 10: **ChangeLog**
Tracks structural changes to the SoR schema.

**Excel Table Name**: `ChangeLog`

**Columns**:
- `ChangeID` — Text, Required, Unique
- `SheetName` — Text, Required
- `FieldName` — Text
- `OldValue` — Text
- `NewValue` — Text
- `ChangedBy` — Text
- `ChangedAt` — DateTime, Required

**Note**: This sheet logs **schema changes** for governance and compliance.

---

## Setup Instructions

### 1. Create Excel Workbook
1. Open Excel and create a new workbook
2. Create **10 sheets** named exactly: `Roles`, `Companies`, `Contacts`, `Outreach`, `Interviews`, `Consulting`, `Metrics`, `StatusHistory`, `FlowErrors`, `ChangeLog`
3. **Do NOT create any additional sheets**

### 2. Set Up Excel Tables
For each sheet:
1. Add column headers according to the schema above
2. Select the data range including headers
3. Insert → Table (or Ctrl+T)
4. Name the table **exactly** after the sheet name (e.g., sheet `Roles` → table named `Roles`)
5. Enable "My table has headers"

### 3. Configure Data Validation
Set up dropdown lists for:
- **Roles**: Status (Identified, Applied, Interviewing, Closed), Seniority
- **Contacts**: RelationshipStrength (Weak, Warm, Strong)
- **Outreach**: Channel (Email, LinkedIn, Referral, Other), MessageType, ResponseType (Positive, Neutral, Negative, None)
- **Interviews**: Stage (Screen, Hiring Manager, Panel, Final, Offer), Outcome (Pass, Fail, Pending)
- **Consulting**: Type (Discovery, Proposal, Implementation, Retainer, Training), Status (Open, In Progress, Closed Won, Closed Lost)
- **StatusHistory**: EntityType (Role, Outreach, Interview, Consulting)
- **FlowErrors**: Resolved (Yes, No)

### 4. Apply Conditional Formatting
- **Roles**: Color-code by Status (green=Interviewing, blue=Applied, gray=Closed)
- **Roles**: Heat map for FitScore (red=low, yellow=medium, green=high)
- **Outreach**: Highlight overdue NextActionDate
- **Interviews**: Highlight upcoming ScheduledDate
- **FlowErrors**: Highlight unresolved errors (Resolved="No")

### 5. Set Up Foreign Key Relationships
Document and validate FK relationships:
- **Roles.CompanyID** → Companies.CompanyID
- **Contacts.CompanyID** → Companies.CompanyID
- **Outreach.ContactID** → Contacts.ContactID
- **Outreach.CompanyID** → Companies.CompanyID
- **Outreach.RoleID** → Roles.RoleID
- **Interviews.RoleID** → Roles.RoleID
- **Interviews.CompanyID** → Companies.CompanyID
- **Consulting.CompanyID** → Companies.CompanyID

Use Excel formulas (e.g., VLOOKUP, XLOOKUP) to validate FK references.

### 6. Configure Computed Fields (Metrics Sheet)
The Metrics sheet should contain formulas that compute:
- Count of Roles by Status
- Count of Outreach by ResponseType
- Average FitScore
- Total Consulting ValueEstimate
- Weekly activity counts

**These are populated by automation scripts**, not manual entry.

### 7. Audit Logic Setup
- **StatusHistory**: Should be populated by automation when any Status field changes
- **FlowErrors**: Should be populated by Copilot flows when errors occur
- **ChangeLog**: Should be populated when schema changes are made

### 8. Format and Protection
- Apply professional formatting (fonts, colors, borders)
- Protect audit sheets (StatusHistory, FlowErrors, ChangeLog) from manual editing
- Lock formula cells in Metrics sheet
- Allow editing only in data entry cells

### 9. Save Template
- Save as `system-of-record-template.xlsx`
- Use this as a template; copy it for actual use
- Version control: Include date in filename when making copies

---

## Required Excel Features

### Excel Tables
- All sheets must use Excel Tables (Insert → Table)
- Table names must match sheet names exactly
- Enables auto-expansion and structured references

### Data Validation
- All dropdown fields must use Data Validation lists
- Prevents invalid data entry
- Ensures data consistency

### Conditional Formatting
- Visual indicators for priorities, statuses, deadlines
- Heat maps for scores
- Alert highlighting for errors and overdue items

### Foreign Key Validation
- Use VLOOKUP/XLOOKUP to validate FK references
- Add helper columns if needed to flag invalid FKs
- Ensure referential integrity

### Named Ranges
- Create named ranges for dropdown lists
- Makes formulas more readable
- Easier to maintain

---

## Validation Rules

### Required Fields
- All fields marked "Required" must have values
- Use conditional formatting to highlight missing required fields

### Unique IDs
- All ID fields must be unique within their sheet
- Use Excel's conditional formatting to detect duplicates

### Data Types
- Text fields: Short text (255 char max recommended)
- Number fields: Numeric values only
- Date fields: Valid dates only
- DateTime fields: Date and time

### Dropdown Constraints
- All dropdown fields must use values from controlled lists
- No free-text entry in dropdown fields

---

## Integration Notes

This Excel template integrates with:
- **Python automation scripts**: Read/write via openpyxl
- **Copilot Studio flows**: Via Excel connector
- **Power Automate**: Via Excel Online connector
- **Dashboard tools**: Source data for dashboards

---

## Migration from Legacy Sheets

If migrating from legacy schema:
- **Jobs** → **Roles** (map fields, enhance with FitScore)
- **Applications** → **Roles** Status field + **StatusHistory** (split application data)
- **Weekly_Goals** → **Metrics** (convert goals to computed metrics)
- **Audit_Log** → **FlowErrors** + **ChangeLog** (split by error type)
- **Dashboard** → Remove (dashboards are separate files in `dashboards/` folder)

---

## Versioning

- Template version: 1.0
- Schema version: 1.0
- Last updated: Based on Canonical 10-Sheet SoR Schema
- No additional sheets permitted
- No sheet renaming permitted
- Column changes require schema update

---

## End of Template Documentation
